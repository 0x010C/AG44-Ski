<!doctype html>

<html lang="fr">
<head>
	<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
	<!--[if lt IE 9]><script src="js/html5.js"></script><![endif]-->
	<meta charset="UTF-8">
	<title>Ski path finder</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="css/style.css" media="all">

	<!-- Inclusion de jQuery -->
	<script src="js/jquery-1.10.2.js"></script>
	<script src="js/jquery-ui.js"></script>
	<!-- Inclusion des dÃ©pendances de imgNotes -->
    <script src="js/imgNotes/jquery.fs.zoetrope.min.js"></script>
    <script src="js/imgNotes/toe.min.js"></script>
    <script src="js/imgNotes/jquery.mousewheel.min.js"></script>
    <script src="js/imgNotes/imgViewer.min.js"></script>
    <!-- Inclusion de imgNotes -->
    <script src="js/imgNotes/imgNotes.js"></script>

    <!-- Initialisation de jQuery-ui draggable -->
	<script>
	 	function setDrag() {
	 		var left = $("#body").width() - $("#image").width();
			var top = $("#body").height() - $("#image").height() - $("#footer").height();
			var right = 0;
			var bottom = 0;
			$( "#image" ).draggable({ cursor: "move", scroll: false, containment: [left, top, right, bottom]});
	 	}
		$(window).resize(function() {
			setDrag();
		});
		$(function() {
			setDrag();
		});
	</script>
</head>
<body id="body">
	
	<header role="banner">
		<h1>Ski path finder</h1>
	</header>

	<section role="main" id="main">
		<div id="imgdiv">
			<img src="img/pistes.jpg" id="image" />
		</div>
		<div id=txt></div>
	</section>

	<footer role="contentinfo" id="footer">
		<ul>
			<li><a href="http://0x010c.fr">par Antoine Lamielle</a></li>
			<li><a href="#">licence GNU GPL v3</a></li>
			<li><a href="https://github.com/0x010C/AG44-Ski/">fork me on Github</a></li>
		</ul>
	</footer>
	
	<!-- Activation de imgNotes -->
<script type="text/javascript">
;(function($) {
	$(document).ready(function() {
		var $img = $("#image").imgNotes({
					onShow: $.noop,
					onAdd: function() {
							this.options.vAll = "bottom";
							this.options.hAll = "middle";
							var elem = $(document.createElement('span')).addClass("marker black").html(this.noteCount).attr("title", "");
							var self = this;
							$(elem).tooltip({
									content: function() {
												return $(elem).data("note");
											}
							});
							return elem;
					} 
		});
		$img.imgNotes("import", [	{x: "0.5", y:"0.5", note:"AFL Grand Final Trophy"}, 
									{x: "0.322", y:"0.269", note: '\
										<center><b>Brisbane Lions Flag</b><br/>\
										<img src="http://www.lions.com.au/static-resources/themes/brisbane/images/logo-brisbane.png"/></center>\
										<a href="http://www.lions.com.au/" target="blank">The Brisbane Lions</a> \
										is an <a href="http://en.wikipedia.org/wiki/Australian_rules_football" target="blank">Australian rules football club.</a>'
									},
									{x: "0.824", y: "0.593", note: "Fluffy microphone"}]);
		var $toggle = $("#toggleEdit");
		if ($img.imgNotes("option","canEdit")) {
			$toggle.text("View");
		} else {
			$toggle.text("Edit");
		}
		$toggle.on("click", function() {
									var $this = $(this);
									if ($this.text()=="Edit") {
										$this.text("View");
										$img.imgNotes("option", "canEdit", true);
									} else {
										$this.text('Edit');
										$img.imgNotes('option', 'canEdit', false);
									}
		});
		var $export = $("#export");
		$export.on("click", function() {
									var $table = $("<table/>").addClass("gridtable");
									var notes = $img.imgNotes('export');
									$table.append("<th>X</th><th>Y</th><th>NOTE</th>"); 
									$.each(notes, function(index, item) {
										$table.append("<tr><td>" + item.x + "</td><td>" + item.y + "</td><td>" + item.note + "</td></tr>");
									});
									$('#txt').html($table);
		});
  });
})(jQuery);
</script>

</body>
</html>

